+++
title = "About this blog"
date = "2020-08-01"
publishDate = "2020-08-01"
summary = "The obligatory meta post about how I made this blog"
draft = true
slug = "about-this-blog"
+++

# About this blog

It wouldn't be a software engineer's personal website without a meta post describing the technology behind it, so here we go!

## Rules of engagement

First, I layed down the following rules:

1. It has to be free across the board
1. No JavaScript anywhere in the stack
1. Avoid markup/styling duplication
1. No frivolous unused features

In the end I was mostly able to adhere to these rules, and created something that I now quite enjoy working with, nice! Next I'll dive deeper into the concrete details and explain the rationale behind some of the choices.

## The stack

1. Domain & DNS
    1. [Google Domains](https://domains.google/)
    1. [Cloudflare](https://www.cloudflare.com/)
1. Hosting
    1. [GitHub Pages](https://pages.github.com/)
1. Content management
    1. [Hugo](https://gohugo.io/)
1. Deployment
    1. [GitHub Actions](https://github.com/features/actions)
        1. [peaceiris/actions-hugo](https://github.com/peaceiris/actions-hugo)
        1. [peaceiris/actions-gh-pages](https://github.com/peaceiris/actions-gh-pages)

I guess you could call it the GDCGHPGHA stack? Not every collection of tools needs a cute name and a manifesto, it's just as valid to lean on your own knowledge and experience to solve problems as it is to use well adopted technology stacks, just pick the right tool for the right job!

### Google Domains

The only part of the stack that you cannot get for free is of course the domain name.

I use Google Domains a my registrar. It's a bit of a strange choice, because the first thing I do after registering a domain through them is change the nameservers to Cloudflare. When you do this you opt out of some nice features like [painless email forwarding](https://domains.google/getting-started/email/) and [synthetic DNS records](https://support.google.com/domains/answer/6069273?hl=en).

So... maybe I should just find a new registrar? To me the return on investment here is much smaller than everything else after it, so maybe I'll revisit it later. For now, it's just a thing you touch once and never care about again, so move on after you get it right.

### Cloudflare

I hardly scratch the surface of what Cloudflare offers, but these two simple things are available for free that I like to use for my projects:
1. Origin fault tolerance
1. Just Enough™ analytics

Origin fault tolerance just means that if GitHub pages is unavailable my website will be served from the Cloudflare cache instead.

GitHub Pages, to my knowledge, doesn't expose analytics data. I don't need (or want) Google Analytics, but I do at least want to know if content I release is being requested. Cloudflare exposes exactly that, and it works perfectly fine for my use case (tiny blog)

There are a couple configuration changes I make to Cloudflare in the early days as well:
1. Caching configuration
    1. Always Online™: **enabled**
    1. Development Mode: **enabled**

## GitHub Pages

I loathe setting up infrastructure, despite finding it very interesting. GitHub Pages is just a no nonsense CDN for static content that lives directly inside of the remote code repository that everyone already uses.

It takes almost no setup and works well, what's the catch?

The first catch is that a GitHub Pages repository cannot exceed 1GB. You won't hit this limit with plain text content, but once you start introducing images it won't take long.

The second catch is that GitHub will reportedly shutoff access to your content if the request volume is deemed to be too high. The limit is neither explicitly defined nor is there a way to tell if you're at risk.

If you can stomach both of these risks, it makes for a solid way to get started for free! You should keep it in the back of your mind though that eventually you will have to cross the bridge and take on some infrastructure of your own, but that is a great problem to have because it means there is a demand for your content, congratulations!

### Mitigating the GitHub shutoff with Cloudflare

Note that the Always Online™️ feature we enabled previously in Cloudflare should in theory cover your ass if GitHub deems your page too hot to handle. You won't be able to publish new content, or even change old content if you've been shutoff, but it at least keeps your content in front of the eyes of the crowd that bombed it with love in the first place!

Hopefully you had a plan for rolling your own infrastructure, maybe I'll run into the situation above and have to live through this myself. If that happens, expect a nice blog post about it ;)

## Content management

Arguably the meat of the stack is the CMS. I landed on Hugo because it was the only popular solution I could find that satisfied both of the following:

1. No JavaScript anywhere in the stack
1. Avoid markup/styling duplication

Hugo being the only solution left on my short list made it the winner by default, however, getting started with it was a painful romp through a slew of new abstract concepts to learn and reason about.

### From zero to Hugo in sixty... minutes

In line with my goal of not adding frivolous unused features, I chose not to introduce a theme. Turns out this ends up creating a broken site by default, and the errors reported aren't particularly helpful.

It started to dawn on me why the [getting started documentation](https://gohugo.io/getting-started/quick-start/) includes adding a theme, because that would have included the missing boilerplate to get content rendering on the page.

I was missing default layouts, most importantly the `baseof.html` file which is the **entire chrome of the website**! Why that isn't included in the code generated by `hugo new` I have no idea. 

Things started to click much more quickly after swallowing my pride and watching the [fantastic tutorial videos by Mike Dane](https://www.youtube.com/watch?list=PLLAZ4kZ9dFpOnyRlyS-liKL5ReHDcj4G3&v=qtIqKaDlqXo), which are often referenced in the Hugo documentation.

### Quick JavaScript rant

You may be wondering why I want anything to do with JavaScript. I know how people look at me when I express my distaste for JavaScript, but I stand by it.

In my near decade of work as a professional software engineer with small to mid sized technology companies, I dare say that nothing has caused more fundamental and systemic issues than JavaScript. 

I am going to stop the rant here, but you can count on me expanding on this topic in a future post ;)

## Deployment

I knew right away that GitHub Actions was going to be perfect for this, given their free offering for public repositories. Quite simply, it's a simple method of running deployment code on push to a branch.

I knew ahead of time that I needed to setup the git branches correctly:
1. `master`: Website source code
1. `gh-pages`: Website static content served through GitHub pages

When the `hugo` command is run without any arguments, it builds the site into a `public` directory, which is exactly what we want to push into the `gh-pages` branch. So, let's get this to happen in the GitHub actions job!

Feel free to reference my [GitHub actions configuration file](https://github.com/corytheboyd/website/blob/master/.github/workflows/main.yml), which is fairly self explanatory. Here is a simplified slice of the relevant steps in the build:

{{< gist corytheboyd 72219b9e70776db5c5a76662b8efc80f >}}

Huge shoutout to [Shohei Ueda (peaceiris)](https://github.com/peaceiris) for publishing the GitHub Actions plugins for downloading the Hugo binary and uploading content to the gh-pages branch, that saved me tons of time, I actually only spent about 15 minutes from "I should figure out deployment" to having it completely working, it felt amazing!

## Summary

I hope this was helpful to anyone looking to host their own personal website! It can be hard to know what to use and why when you're getting started, and perhaps my list of selected technologies along with my justifications helps you to create your own setup!

And to conclude this blog post, I just want to say that I don't consider this website finished at all yet! Some things off the top of my head that are on deck:
* Styling needs some love, as it always does
* Formatting for different devices (easy to do, likely the next thing I tackle)
* Hosting non-text assets on another CDN (and incorporate into the build/deploy process)
* Get people to actually read and appreciate what I have to say ;)
